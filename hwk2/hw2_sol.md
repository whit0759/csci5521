% Homework #2  
  CSCI 5521  
  Professor Kuang
% Christopher White
% March 14, 2019


# Question 1

## 1(a)
$$p(\textbf x|\Sigma_i) = \frac{1}{(2\pi)^{d/2} |\Sigma_i|^{1/2}} \exp ({-\frac{1}{2} (\textbf x - \mu_i)^T\Sigma_i^{-1}(\textbf x - \mu_i)})$$

$$\log{p(\textbf x |\Sigma_i)} = -\frac{1}{2} (\textbf x - \mu_i)^T \Sigma_i^{-1} (\textbf x - \mu_i) - \frac{d}{2} \log{2\pi} - \frac{1}{2}\log{|\Sigma_i|}$$

$$L(\Sigma_i|\textbf x^t) = \sum_{t=1}^N \log{p(\textbf x^t|\Sigma_i)}$$
$$=\sum_{t=1}^N -\frac{1}{2} (\textbf x - \mu_i)^T \Sigma_i^{-1} (\textbf x - \mu_i) - \frac{d}{2} \log{2\pi} - \frac{1}{2}\log{|\Sigma_i|}$$

$$=- \frac{N d}{2} \log{2\pi} - \frac{N}{2}\log{|\Sigma_i|} -\frac{1}{2}\sum_{t=1}^N (\textbf x - \mu_i)^T \Sigma_i^{-1} (\textbf x - \mu_i)$$

### For Model 1:
$$S_i = \frac{\sum_t r_i^t (x^t - m_i)(x^t - m_i)^T}{\sum_t r_i^t}$$

### For Model 2:
$$L(\Sigma_i|\textbf x^t)=- \frac{N d}{2} \log{2\pi} - \frac{N}{2}\log{|\Sigma_i|} -\frac{1}{2}\sum_{t=1}^N (\textbf x^t - \mu)^T \Sigma_i^{-1} (\textbf x^t - \mu)$$

$$\frac{d}{d\Sigma_i} L(\Sigma_i|\textbf x^t) = \frac{d}{d\Sigma_i} \left( - \frac{N}{2}\log{|\Sigma_i|} -\frac{1}{2}\sum_{t=1}^N (\textbf x^t - \mu)^T \Sigma_i^{-1} (\textbf x^t - \mu)\right)$$

$$=- \frac{N}{2}\frac{1}{|\Sigma_i|} |\Sigma_i| (\Sigma_i^{-T}) -\frac{1}{2} \sum_{t=1}^N \left(-\Sigma_i^{-T} (\textbf x^t - \mu) (\textbf x^t -\mu)^T \Sigma_i^{-T}\right) = 0$$

$$N \Sigma_i^{-T} =\sum_{t=1}^N \left(\Sigma_i^{-T} (\textbf x^t - \mu) (\textbf x^t - \mu)^T \Sigma_i^{-T} \right)$$

$$\Sigma_i^T N = \sum_{t=1}^N \left( (\textbf x^t - \mu) (\textbf x^t - \mu)^T \right)$$

$$\Sigma_i^T = \frac{\sum_{t=1}^N \left( (\textbf x^t - \mu) (\textbf x^t - \mu)^T \right)}{N}$$

However, $\Sigma_i^T = \Sigma_i$ because it is symmetric.

$$S_i = \frac{\sum_{t=1}^N \left( (\textbf x^t - \mu) (\textbf x^t - \mu)^T \right)}{N}$$

$$S_1 = S_2$$

$$S_1 + S_2 = 2 S = \frac{\sum_{t=1}^{N_1} \left( (\textbf x^t - \mu) (\textbf x^t - \mu)^T \right)}{N_1} +\frac{\sum_{t=1}^{N_2} \left( (\textbf x^t - \mu) (\textbf x^t - \mu)^T \right)}{N_2}$$

$$S = \frac{1}{2} (S_1+S_2)$$


### For Model 3:
$$S_i = \alpha_i I$$

$$L(\Sigma_i|\textbf x^t) = \sum_{t=1}^N \log{p(\textbf x^t|\Sigma_i)}$$

$$=- \frac{N d}{2} \log{2\pi} - \frac{N}{2}\log{|\alpha_i I|} -\frac{1}{2}\sum_{t=1}^N (\textbf x^t - \mu_i)^T \alpha_i^{-1} I (\textbf x^t - \mu_i)$$

$$\frac{d}{d\alpha_i} L(\alpha_i | \textbf x^t) = -\frac{N}{2} \frac{d}{d\alpha_i} \log{\alpha_i^d} - \frac{1}{2} \sum_{t=1}^{N} \frac{d}{d\alpha_i} (\textbf x^t - \mu_i)^T \alpha_i^{-1} (\textbf x^t - \mu_i)$$

$$= -\frac{N}{2} \frac{\textrm d}{\alpha_i} + \frac{1}{2 \alpha_i^2} \sum_{t=1}^{N} (\textbf x^t - \mu_i)^T (\textbf x^t - \mu_i) = 0$$

$$N \textrm d \alpha_i = \sum_{t=1}^{N} (\textbf x^t - \mu_i)^T (\textbf x^t - \mu_i)$$

$$\alpha_i = \frac{\sum_{t=1}^{N} (\textbf x^t - \mu_i)^T (\textbf x^t - \mu_i)}{N \textrm d}$$

DISCRIMINANT: 
$$g_i(\textbf x^t) = \log{\hat P(C_i)}-\frac{d}{2}\log{2\pi}-\frac{d}{2}
\log{\alpha_i}-\frac{1}{2\alpha_i}(\textbf x^t - m_i)^T(\textbf x^t - m_i)$$

## 1(b)
See results in MATLAB window of `MultiGaussian()` by running `script_1b.m`.

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.2
    mu1:    0.43062     2.0235     3.1758    -2.4272    -2.5234     3.2378    -5.5208    -6.6921 
    mu2:     4.5841     6.4933     6.4265     1.6891     2.2943     8.3626   -0.16579    -1.8048 
    ------------------------------------------
    S1:     1.9283    0.23454    0.77191     1.0321    0.43221     1.2648     1.1728     -1.232 
    S1:    0.23454      3.659    0.31235   -0.13452     1.5821     1.0301   -0.19427     3.2756 
    S1:    0.77191    0.31235     8.1131     1.3347   -0.42859     1.7792    0.35497    0.23201 
    S1:     1.0321   -0.13452     1.3347     4.2296    0.94821     0.7471     1.0682      1.981 
    S1:    0.43221     1.5821   -0.42859    0.94821     4.1354     1.0028   -0.54523     3.4385 
    S1:     1.2648     1.0301     1.7792     0.7471     1.0028     4.0696   -0.19595     2.3004 
    S1:     1.1728   -0.19427    0.35497     1.0682   -0.54523   -0.19595     4.2163    -1.7099 
    S1:     -1.232     3.2756    0.23201      1.981     3.4385     2.3004    -1.7099     17.095 
    ------------------------------------------
    S2:     3.4733     2.0992      2.608     2.6506     1.7989     1.8568     2.7181     2.9765 
    S2:     2.0992     5.8673     2.2109     2.7575     3.2032     2.9295     2.7963     5.9386 
    S2:      2.608     2.2109     8.8389     3.4241     2.8666     2.2617     2.7934     5.2586 
    S2:     2.6506     2.7575     3.4241     8.2867     3.6293     2.6992     2.0496     8.5185 
    S2:     1.7989     3.2032     2.8666     3.6293     5.6484     2.9483     3.2971     4.8906 
    S2:     1.8568     2.9295     2.2617     2.6992     2.9483     3.7835     2.2673     4.5415 
    S2:     2.7181     2.7963     2.7934     2.0496     3.2971     2.2673     8.3339     4.3679 
    S2:     2.9765     5.9386     5.2586     8.5185     4.8906     4.5415     4.3679     20.135 

    PC11 =

        0.3000


    PC21 =

        0.7000


    mu11 =

        0.4306    2.0235    3.1758   -2.4272   -2.5234    3.2378   -5.5208   -6.6921


    mu21 =

        4.5841    6.4933    6.4265    1.6891    2.2943    8.3626   -0.1658   -1.8048


    S11 =

        1.9283    0.2345    0.7719    1.0321    0.4322    1.2648    1.1728   -1.2320
        0.2345    3.6590    0.3123   -0.1345    1.5821    1.0301   -0.1943    3.2756
        0.7719    0.3123    8.1131    1.3347   -0.4286    1.7792    0.3550    0.2320
        1.0321   -0.1345    1.3347    4.2296    0.9482    0.7471    1.0682    1.9810
        0.4322    1.5821   -0.4286    0.9482    4.1354    1.0028   -0.5452    3.4385
        1.2648    1.0301    1.7792    0.7471    1.0028    4.0696   -0.1960    2.3004
        1.1728   -0.1943    0.3550    1.0682   -0.5452   -0.1960    4.2163   -1.7099
    -1.2320    3.2756    0.2320    1.9810    3.4385    2.3004   -1.7099   17.0954


    S21 =

        3.4733    2.0992    2.6080    2.6506    1.7989    1.8568    2.7181    2.9765
        2.0992    5.8673    2.2109    2.7575    3.2032    2.9295    2.7963    5.9386
        2.6080    2.2109    8.8389    3.4241    2.8666    2.2617    2.7934    5.2586
        2.6506    2.7575    3.4241    8.2867    3.6293    2.6992    2.0496    8.5185
        1.7989    3.2032    2.8666    3.6293    5.6484    2.9483    3.2971    4.8906
        1.8568    2.9295    2.2617    2.6992    2.9483    3.7835    2.2673    4.5415
        2.7181    2.7963    2.7934    2.0496    3.2971    2.2673    8.3339    4.3679
        2.9765    5.9386    5.2586    8.5185    4.8906    4.5415    4.3679   20.1353


    ErrTest1 =

        0.2000
            0
            0

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.23
    mu1:     1.0658     2.6548     3.2977    -1.6793    -1.4987     4.3959    -4.2138    -4.9679 
    mu2:     2.8221     4.4669     4.8537    0.51923    0.37638     6.2585    -2.6611    -3.8175 
    ------------------------------------------
    S1:     1.3816   -0.27405    0.68356    0.28188     1.0317    0.47828   -0.29784    0.30388 
    S1:   -0.27405      2.633     2.1369    0.95217     1.1237   -0.46126  -0.052341     2.7848 
    S1:    0.68356     2.1369     7.1517     1.5667    0.84272    0.19932     2.7759     2.8105 
    S1:    0.28188    0.95217     1.5667     3.1578    0.68105   -0.47999    0.24738     2.3803 
    S1:     1.0317     1.1237    0.84272    0.68105     2.2748 -0.0038062   -0.58546    0.77435 
    S1:    0.47828   -0.46126    0.19932   -0.47999 -0.0038062     1.2469    0.68031   -0.20541 
    S1:   -0.29784  -0.052341     2.7759    0.24738   -0.58546    0.68031     4.1857   -0.75495 
    S1:    0.30388     2.7848     2.8105     2.3803    0.77435   -0.20541   -0.75495     10.834 
    ------------------------------------------
    S2:     2.9707     1.0855     2.9514    0.57866  -0.092368   0.067599    0.88675     1.7887 
    S2:     1.0855     5.0624     2.4893    0.17835     2.7711   -0.32819    0.50148     0.0514 
    S2:     2.9514     2.4893     11.826   0.089452    0.83721    0.12939   0.022258   -0.84529 
    S2:    0.57866    0.17835   0.089452     5.4082   0.054843     1.0249     4.3627     2.3291 
    S2:  -0.092368     2.7711    0.83721   0.054843     4.3167     1.0396     0.5454     1.6923 
    S2:   0.067599   -0.32819    0.12939     1.0249     1.0396     2.7282     1.7313     2.1908 
    S2:    0.88675    0.50148   0.022258     4.3627     0.5454     1.7313     11.481     2.7512 
    S2:     1.7887     0.0514   -0.84529     2.3291     1.6923     2.1908     2.7512     13.119 

    PC12 =

        0.3000


    PC22 =

        0.7000


    mu12 =

        1.0658    2.6548    3.2977   -1.6793   -1.4987    4.3959   -4.2138   -4.9679


    mu22 =

        2.8221    4.4669    4.8537    0.5192    0.3764    6.2585   -2.6611   -3.8175


    S12 =

        1.3816   -0.2741    0.6836    0.2819    1.0317    0.4783   -0.2978    0.3039
    -0.2741    2.6330    2.1369    0.9522    1.1237   -0.4613   -0.0523    2.7848
        0.6836    2.1369    7.1517    1.5667    0.8427    0.1993    2.7759    2.8105
        0.2819    0.9522    1.5667    3.1578    0.6811   -0.4800    0.2474    2.3803
        1.0317    1.1237    0.8427    0.6811    2.2748   -0.0038   -0.5855    0.7744
        0.4783   -0.4613    0.1993   -0.4800   -0.0038    1.2469    0.6803   -0.2054
    -0.2978   -0.0523    2.7759    0.2474   -0.5855    0.6803    4.1857   -0.7550
        0.3039    2.7848    2.8105    2.3803    0.7744   -0.2054   -0.7550   10.8345


    S22 =

        2.9707    1.0855    2.9514    0.5787   -0.0924    0.0676    0.8867    1.7887
        1.0855    5.0624    2.4893    0.1783    2.7711   -0.3282    0.5015    0.0514
        2.9514    2.4893   11.8262    0.0895    0.8372    0.1294    0.0223   -0.8453
        0.5787    0.1783    0.0895    5.4082    0.0548    1.0249    4.3627    2.3291
    -0.0924    2.7711    0.8372    0.0548    4.3167    1.0396    0.5454    1.6923
        0.0676   -0.3282    0.1294    1.0249    1.0396    2.7282    1.7313    2.1908
        0.8867    0.5015    0.0223    4.3627    0.5454    1.7313   11.4810    2.7512
        1.7887    0.0514   -0.8453    2.3291    1.6923    2.1908    2.7512   13.1191


    ErrTest2 =

        0.2300
            0
            0

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.12
    mu1:    0.97473     2.6233      3.177    -1.4652    -1.3053      4.516    -4.3197    -5.5215 
    mu2:     1.4916     3.1655     3.6504   -0.81618   -0.35148     5.1345     -3.277    -4.7293 
    ------------------------------------------
    S1:    0.26426   0.084393   0.061156  -0.085321 -0.0060191  -0.076364  -0.016044   0.080466 
    S1:   0.084393    0.42581  -0.084981   -0.10514  -0.012187  -0.089623    0.11651   -0.07582 
    S1:   0.061156  -0.084981    0.60629  -0.037661   -0.09252  -0.033265    0.08249   0.013285 
    S1:  -0.085321   -0.10514  -0.037661    0.44002  -0.035577   -0.14464   -0.10444   0.074589 
    S1: -0.0060191  -0.012187   -0.09252  -0.035577    0.43269   0.053367  -0.099753   0.014154 
    S1:  -0.076364  -0.089623  -0.033265   -0.14464   0.053367    0.59442   0.070731  -0.024553 
    S1:  -0.016044    0.11651    0.08249   -0.10444  -0.099753   0.070731    0.54428  -0.030454 
    S1:   0.080466   -0.07582   0.013285   0.074589   0.014154  -0.024553  -0.030454    0.39816 
    ------------------------------------------
    S2:     2.7945    0.41095   -0.38458    0.59849   -0.41287    0.16596    0.35736   -0.48835 
    S2:    0.41095     2.5371   -0.34972  -0.036702   -0.29616    0.05865    0.17826   0.088163 
    S2:   -0.38458   -0.34972     2.1605   -0.25595  -0.049037  -0.030287   0.035702    -0.2838 
    S2:    0.59849  -0.036702   -0.25595     2.9685   -0.87774    0.10262   -0.34245   -0.32702 
    S2:   -0.41287   -0.29616  -0.049037   -0.87774     3.5095   0.074612   -0.76268    0.19421 
    S2:    0.16596    0.05865  -0.030287    0.10262   0.074612     2.9193    0.64239    0.35185 
    S2:    0.35736    0.17826   0.035702   -0.34245   -0.76268    0.64239     2.9478    0.27836 
    S2:   -0.48835   0.088163    -0.2838   -0.32702    0.19421    0.35185    0.27836     2.6123 

    PC13 =

        0.3000


    PC23 =

        0.7000


    mu13 =

        0.9747    2.6233    3.1770   -1.4652   -1.3053    4.5160   -4.3197   -5.5215


    mu23 =

        1.4916    3.1655    3.6504   -0.8162   -0.3515    5.1345   -3.2770   -4.7293


    alpha1 =

        0.2643    0.0844    0.0612   -0.0853   -0.0060   -0.0764   -0.0160    0.0805
        0.0844    0.4258   -0.0850   -0.1051   -0.0122   -0.0896    0.1165   -0.0758
        0.0612   -0.0850    0.6063   -0.0377   -0.0925   -0.0333    0.0825    0.0133
    -0.0853   -0.1051   -0.0377    0.4400   -0.0356   -0.1446   -0.1044    0.0746
    -0.0060   -0.0122   -0.0925   -0.0356    0.4327    0.0534   -0.0998    0.0142
    -0.0764   -0.0896   -0.0333   -0.1446    0.0534    0.5944    0.0707   -0.0246
    -0.0160    0.1165    0.0825   -0.1044   -0.0998    0.0707    0.5443   -0.0305
        0.0805   -0.0758    0.0133    0.0746    0.0142   -0.0246   -0.0305    0.3982


    alpha2 =

        2.7945    0.4110   -0.3846    0.5985   -0.4129    0.1660    0.3574   -0.4884
        0.4110    2.5371   -0.3497   -0.0367   -0.2962    0.0586    0.1783    0.0882
    -0.3846   -0.3497    2.1605   -0.2560   -0.0490   -0.0303    0.0357   -0.2838
        0.5985   -0.0367   -0.2560    2.9685   -0.8777    0.1026   -0.3425   -0.3270
    -0.4129   -0.2962   -0.0490   -0.8777    3.5095    0.0746   -0.7627    0.1942
        0.1660    0.0586   -0.0303    0.1026    0.0746    2.9193    0.6424    0.3518
        0.3574    0.1783    0.0357   -0.3425   -0.7627    0.6424    2.9478    0.2784
    -0.4884    0.0882   -0.2838   -0.3270    0.1942    0.3518    0.2784    2.6123


    ErrTest3 =

        0.1200
            0
            0

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.17
    mu1:    0.43062     2.0235     3.1758    -2.4272    -2.5234     3.2378    -5.5208    -6.6921 
    mu2:     4.5841     6.4933     6.4265     1.6891     2.2943     8.3626   -0.16579    -1.8048 
    ------------------------------------------
    S1:     2.7008     1.1668     1.6899     1.8414     1.1156     1.5608     1.9454    0.87225 
    S1:     1.1668     4.7632     1.2616     1.3115     2.3927     1.9798      1.301     4.6071 
    S1:     1.6899     1.2616      8.476     2.3794      1.219     2.0204     1.5742     2.7453 
    S1:     1.8414     1.3115     2.3794     6.2581     2.2887     1.7232     1.5589     5.2498 
    S1:     1.1156     2.3927      1.219     2.2887     4.8919     1.9755     1.3759     4.1646 
    S1:     1.5608     1.9798     2.0204     1.7232     1.9755     3.9265     1.0357      3.421 
    S1:     1.9454      1.301     1.5742     1.5589     1.3759     1.0357     6.2751      1.329 
    S1:    0.87225     4.6071     2.7453     5.2498     4.1646      3.421      1.329     18.615 
    ------------------------------------------
    S2:     2.7008     1.1668     1.6899     1.8414     1.1156     1.5608     1.9454    0.87225 
    S2:     1.1668     4.7632     1.2616     1.3115     2.3927     1.9798      1.301     4.6071 
    S2:     1.6899     1.2616      8.476     2.3794      1.219     2.0204     1.5742     2.7453 
    S2:     1.8414     1.3115     2.3794     6.2581     2.2887     1.7232     1.5589     5.2498 
    S2:     1.1156     2.3927      1.219     2.2887     4.8919     1.9755     1.3759     4.1646 
    S2:     1.5608     1.9798     2.0204     1.7232     1.9755     3.9265     1.0357      3.421 
    S2:     1.9454      1.301     1.5742     1.5589     1.3759     1.0357     6.2751      1.329 
    S2:    0.87225     4.6071     2.7453     5.2498     4.1646      3.421      1.329     18.615 

    PC11 =

        0.3000


    PC21 =

        0.7000


    mu11 =

        0.4306    2.0235    3.1758   -2.4272   -2.5234    3.2378   -5.5208   -6.6921


    mu21 =

        4.5841    6.4933    6.4265    1.6891    2.2943    8.3626   -0.1658   -1.8048


    S11 =

        2.7008    1.1668    1.6899    1.8414    1.1156    1.5608    1.9454    0.8722
        1.1668    4.7632    1.2616    1.3115    2.3927    1.9798    1.3010    4.6071
        1.6899    1.2616    8.4760    2.3794    1.2190    2.0204    1.5742    2.7453
        1.8414    1.3115    2.3794    6.2581    2.2887    1.7232    1.5589    5.2498
        1.1156    2.3927    1.2190    2.2887    4.8919    1.9755    1.3759    4.1646
        1.5608    1.9798    2.0204    1.7232    1.9755    3.9265    1.0357    3.4210
        1.9454    1.3010    1.5742    1.5589    1.3759    1.0357    6.2751    1.3290
        0.8722    4.6071    2.7453    5.2498    4.1646    3.4210    1.3290   18.6154


    S21 =

        2.7008    1.1668    1.6899    1.8414    1.1156    1.5608    1.9454    0.8722
        1.1668    4.7632    1.2616    1.3115    2.3927    1.9798    1.3010    4.6071
        1.6899    1.2616    8.4760    2.3794    1.2190    2.0204    1.5742    2.7453
        1.8414    1.3115    2.3794    6.2581    2.2887    1.7232    1.5589    5.2498
        1.1156    2.3927    1.2190    2.2887    4.8919    1.9755    1.3759    4.1646
        1.5608    1.9798    2.0204    1.7232    1.9755    3.9265    1.0357    3.4210
        1.9454    1.3010    1.5742    1.5589    1.3759    1.0357    6.2751    1.3290
        0.8722    4.6071    2.7453    5.2498    4.1646    3.4210    1.3290   18.6154


    ErrTest1 =

        0.2000
        0.1700
            0

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.55
    mu1:     1.0658     2.6548     3.2977    -1.6793    -1.4987     4.3959    -4.2138    -4.9679 
    mu2:     2.8221     4.4669     4.8537    0.51923    0.37638     6.2585    -2.6611    -3.8175 
    ------------------------------------------
    S1:     2.1762    0.40574     1.8175    0.43027    0.46967    0.27294    0.29445     1.0463 
    S1:    0.40574     3.8477     2.3131    0.56526     1.9474   -0.39472    0.22457     1.4181 
    S1:     1.8175     2.3131     9.4889    0.82808    0.83997    0.16435     1.3991    0.98259 
    S1:    0.43027    0.56526    0.82808      4.283    0.36795    0.27246     2.3051     2.3547 
    S1:    0.46967     1.9474    0.83997    0.36795     3.2958    0.51791  -0.020032     1.2333 
    S1:    0.27294   -0.39472    0.16435    0.27246    0.51791     1.9875     1.2058    0.99271 
    S1:    0.29445    0.22457     1.3991     2.3051  -0.020032     1.2058     7.8334    0.99815 
    S1:     1.0463     1.4181    0.98259     2.3547     1.2333    0.99271    0.99815     11.977 
    ------------------------------------------
    S2:     2.1762    0.40574     1.8175    0.43027    0.46967    0.27294    0.29445     1.0463 
    S2:    0.40574     3.8477     2.3131    0.56526     1.9474   -0.39472    0.22457     1.4181 
    S2:     1.8175     2.3131     9.4889    0.82808    0.83997    0.16435     1.3991    0.98259 
    S2:    0.43027    0.56526    0.82808      4.283    0.36795    0.27246     2.3051     2.3547 
    S2:    0.46967     1.9474    0.83997    0.36795     3.2958    0.51791  -0.020032     1.2333 
    S2:    0.27294   -0.39472    0.16435    0.27246    0.51791     1.9875     1.2058    0.99271 
    S2:    0.29445    0.22457     1.3991     2.3051  -0.020032     1.2058     7.8334    0.99815 
    S2:     1.0463     1.4181    0.98259     2.3547     1.2333    0.99271    0.99815     11.977 

    PC12 =

        0.3000


    PC22 =

        0.7000


    mu12 =

        1.0658    2.6548    3.2977   -1.6793   -1.4987    4.3959   -4.2138   -4.9679


    mu22 =

        2.8221    4.4669    4.8537    0.5192    0.3764    6.2585   -2.6611   -3.8175


    S12 =

        2.1762    0.4057    1.8175    0.4303    0.4697    0.2729    0.2945    1.0463
        0.4057    3.8477    2.3131    0.5653    1.9474   -0.3947    0.2246    1.4181
        1.8175    2.3131    9.4889    0.8281    0.8400    0.1644    1.3991    0.9826
        0.4303    0.5653    0.8281    4.2830    0.3679    0.2725    2.3051    2.3547
        0.4697    1.9474    0.8400    0.3679    3.2958    0.5179   -0.0200    1.2333
        0.2729   -0.3947    0.1644    0.2725    0.5179    1.9875    1.2058    0.9927
        0.2945    0.2246    1.3991    2.3051   -0.0200    1.2058    7.8334    0.9981
        1.0463    1.4181    0.9826    2.3547    1.2333    0.9927    0.9981   11.9768


    S22 =

        2.1762    0.4057    1.8175    0.4303    0.4697    0.2729    0.2945    1.0463
        0.4057    3.8477    2.3131    0.5653    1.9474   -0.3947    0.2246    1.4181
        1.8175    2.3131    9.4889    0.8281    0.8400    0.1644    1.3991    0.9826
        0.4303    0.5653    0.8281    4.2830    0.3679    0.2725    2.3051    2.3547
        0.4697    1.9474    0.8400    0.3679    3.2958    0.5179   -0.0200    1.2333
        0.2729   -0.3947    0.1644    0.2725    0.5179    1.9875    1.2058    0.9927
        0.2945    0.2246    1.3991    2.3051   -0.0200    1.2058    7.8334    0.9981
        1.0463    1.4181    0.9826    2.3547    1.2333    0.9927    0.9981   11.9768


    ErrTest2 =

        0.2300
        0.5500
            0

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.47
    mu1:    0.97473     2.6233      3.177    -1.4652    -1.3053      4.516    -4.3197    -5.5215 
    mu2:     1.4916     3.1655     3.6504   -0.81618   -0.35148     5.1345     -3.277    -4.7293 
    ------------------------------------------
    S1:     1.5294    0.24767   -0.16171    0.25658   -0.20944   0.044799    0.17066   -0.20394 
    S1:    0.24767     1.4815   -0.21735  -0.070922   -0.15417  -0.015487    0.14738  0.0061713 
    S1:   -0.16171   -0.21735     1.3834   -0.14681  -0.070779  -0.031776   0.059096   -0.13526 
    S1:    0.25658  -0.070922   -0.14681     1.7042   -0.45666  -0.021009   -0.22345   -0.12622 
    S1:   -0.20944   -0.15417  -0.070779   -0.45666     1.9711    0.06399   -0.43122    0.10418 
    S1:   0.044799  -0.015487  -0.031776  -0.021009    0.06399     1.7568    0.35656    0.16365 
    S1:    0.17066    0.14738   0.059096   -0.22345   -0.43122    0.35656     1.7461    0.12396 
    S1:   -0.20394  0.0061713   -0.13526   -0.12622    0.10418    0.16365    0.12396     1.5052 
    ------------------------------------------
    S2:     1.5294    0.24767   -0.16171    0.25658   -0.20944   0.044799    0.17066   -0.20394 
    S2:    0.24767     1.4815   -0.21735  -0.070922   -0.15417  -0.015487    0.14738  0.0061713 
    S2:   -0.16171   -0.21735     1.3834   -0.14681  -0.070779  -0.031776   0.059096   -0.13526 
    S2:    0.25658  -0.070922   -0.14681     1.7042   -0.45666  -0.021009   -0.22345   -0.12622 
    S2:   -0.20944   -0.15417  -0.070779   -0.45666     1.9711    0.06399   -0.43122    0.10418 
    S2:   0.044799  -0.015487  -0.031776  -0.021009    0.06399     1.7568    0.35656    0.16365 
    S2:    0.17066    0.14738   0.059096   -0.22345   -0.43122    0.35656     1.7461    0.12396 
    S2:   -0.20394  0.0061713   -0.13526   -0.12622    0.10418    0.16365    0.12396     1.5052 

    PC13 =

        0.3000


    PC23 =

        0.7000


    mu13 =

        0.9747    2.6233    3.1770   -1.4652   -1.3053    4.5160   -4.3197   -5.5215


    mu23 =

        1.4916    3.1655    3.6504   -0.8162   -0.3515    5.1345   -3.2770   -4.7293


    alpha1 =

        1.5294    0.2477   -0.1617    0.2566   -0.2094    0.0448    0.1707   -0.2039
        0.2477    1.4815   -0.2174   -0.0709   -0.1542   -0.0155    0.1474    0.0062
    -0.1617   -0.2174    1.3834   -0.1468   -0.0708   -0.0318    0.0591   -0.1353
        0.2566   -0.0709   -0.1468    1.7042   -0.4567   -0.0210   -0.2234   -0.1262
    -0.2094   -0.1542   -0.0708   -0.4567    1.9711    0.0640   -0.4312    0.1042
        0.0448   -0.0155   -0.0318   -0.0210    0.0640    1.7568    0.3566    0.1636
        0.1707    0.1474    0.0591   -0.2234   -0.4312    0.3566    1.7461    0.1240
    -0.2039    0.0062   -0.1353   -0.1262    0.1042    0.1636    0.1240    1.5052


    alpha2 =

        1.5294    0.2477   -0.1617    0.2566   -0.2094    0.0448    0.1707   -0.2039
        0.2477    1.4815   -0.2174   -0.0709   -0.1542   -0.0155    0.1474    0.0062
    -0.1617   -0.2174    1.3834   -0.1468   -0.0708   -0.0318    0.0591   -0.1353
        0.2566   -0.0709   -0.1468    1.7042   -0.4567   -0.0210   -0.2234   -0.1262
    -0.2094   -0.1542   -0.0708   -0.4567    1.9711    0.0640   -0.4312    0.1042
        0.0448   -0.0155   -0.0318   -0.0210    0.0640    1.7568    0.3566    0.1636
        0.1707    0.1474    0.0591   -0.2234   -0.4312    0.3566    1.7461    0.1240
    -0.2039    0.0062   -0.1353   -0.1262    0.1042    0.1636    0.1240    1.5052


    ErrTest3 =

        0.1200
        0.4700
            0

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.24
    mu1:    0.43062     2.0235     3.1758    -2.4272    -2.5234     3.2378    -5.5208    -6.6921 
    mu2:     4.5841     6.4933     6.4265     1.6891     2.2943     8.3626   -0.16579    -1.8048 
    ------------------------------------------
    S1:     5.7331          0          0          0          0          0          0          0 
    S1:          0     5.7331          0          0          0          0          0          0 
    S1:          0          0     5.7331          0          0          0          0          0 
    S1:          0          0          0     5.7331          0          0          0          0 
    S1:          0          0          0          0     5.7331          0          0          0 
    S1:          0          0          0          0          0     5.7331          0          0 
    S1:          0          0          0          0          0          0     5.7331          0 
    S1:          0          0          0          0          0          0          0     5.7331 
    ------------------------------------------
    S2:      7.931          0          0          0          0          0          0          0 
    S2:          0      7.931          0          0          0          0          0          0 
    S2:          0          0      7.931          0          0          0          0          0 
    S2:          0          0          0      7.931          0          0          0          0 
    S2:          0          0          0          0      7.931          0          0          0 
    S2:          0          0          0          0          0      7.931          0          0 
    S2:          0          0          0          0          0          0      7.931          0 
    S2:          0          0          0          0          0          0          0      7.931 

    PC11 =

        0.3000


    PC21 =

        0.7000


    mu11 =

        0.4306    2.0235    3.1758   -2.4272   -2.5234    3.2378   -5.5208   -6.6921


    mu21 =

        4.5841    6.4933    6.4265    1.6891    2.2943    8.3626   -0.1658   -1.8048


    S11 =

        5.7331


    S21 =

        7.9310


    ErrTest1 =

        0.2000
        0.1700
        0.2400

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.55
    mu1:     1.0658     2.6548     3.2977    -1.6793    -1.4987     4.3959    -4.2138    -4.9679 
    mu2:     2.8221     4.4669     4.8537    0.51923    0.37638     6.2585    -2.6611    -3.8175 
    ------------------------------------------
    S1:     3.9713          0          0          0          0          0          0          0 
    S1:          0     3.9713          0          0          0          0          0          0 
    S1:          0          0     3.9713          0          0          0          0          0 
    S1:          0          0          0     3.9713          0          0          0          0 
    S1:          0          0          0          0     3.9713          0          0          0 
    S1:          0          0          0          0          0     3.9713          0          0 
    S1:          0          0          0          0          0          0     3.9713          0 
    S1:          0          0          0          0          0          0          0     3.9713 
    ------------------------------------------
    S2:     7.0124          0          0          0          0          0          0          0 
    S2:          0     7.0124          0          0          0          0          0          0 
    S2:          0          0     7.0124          0          0          0          0          0 
    S2:          0          0          0     7.0124          0          0          0          0 
    S2:          0          0          0          0     7.0124          0          0          0 
    S2:          0          0          0          0          0     7.0124          0          0 
    S2:          0          0          0          0          0          0     7.0124          0 
    S2:          0          0          0          0          0          0          0     7.0124 

    PC12 =

        0.3000


    PC22 =

        0.7000


    mu12 =

        1.0658    2.6548    3.2977   -1.6793   -1.4987    4.3959   -4.2138   -4.9679


    mu22 =

        2.8221    4.4669    4.8537    0.5192    0.3764    6.2585   -2.6611   -3.8175


    S12 =

        3.9713


    S22 =

        7.0124


    ErrTest2 =

        0.2300
        0.5500
        0.5500

    TABLE OF TEST RESULTS

    P(C1): 0.3
    P(C2): 0.7
    Error Rate: 0.05
    mu1:    0.97473     2.6233      3.177    -1.4652    -1.3053      4.516    -4.3197    -5.5215 
    mu2:     1.4916     3.1655     3.6504   -0.81618   -0.35148     5.1345     -3.277    -4.7293 
    ------------------------------------------
    S1:     0.4478          0          0          0          0          0          0          0 
    S1:          0     0.4478          0          0          0          0          0          0 
    S1:          0          0     0.4478          0          0          0          0          0 
    S1:          0          0          0     0.4478          0          0          0          0 
    S1:          0          0          0          0     0.4478          0          0          0 
    S1:          0          0          0          0          0     0.4478          0          0 
    S1:          0          0          0          0          0          0     0.4478          0 
    S1:          0          0          0          0          0          0          0     0.4478 
    ------------------------------------------
    S2:     2.7661          0          0          0          0          0          0          0 
    S2:          0     2.7661          0          0          0          0          0          0 
    S2:          0          0     2.7661          0          0          0          0          0 
    S2:          0          0          0     2.7661          0          0          0          0 
    S2:          0          0          0          0     2.7661          0          0          0 
    S2:          0          0          0          0          0     2.7661          0          0 
    S2:          0          0          0          0          0          0     2.7661          0 
    S2:          0          0          0          0          0          0          0     2.7661 

    PC13 =

        0.3000


    PC23 =

        0.7000


    mu13 =

        0.9747    2.6233    3.1770   -1.4652   -1.3053    4.5160   -4.3197   -5.5215


    mu23 =

        1.4916    3.1655    3.6504   -0.8162   -0.3515    5.1345   -3.2770   -4.7293


    alpha1 =

        0.4478


    alpha2 =

        2.7661


    ErrTest3 =

        0.1200
        0.4700
        0.0500

## 1(c)

  Model     Error Test #1     Error Test #2     ErrorTest#3
-------   ----------------   ---------------   -------------
    1           0.20             0.23              0.12
    2           0.17             0.55              0.47
    3           0.24             0.55              0.05

Table: Error Results for Test Data on 3 Models

From the table of error rates, the models each work best on a different data set. Model 2 has the lowest error for test set #1. Model 1 has the lowest error on test set #2. And model 3 has the lowest error on test set #3.

The data is test set #1 is best fit by model 2. This implies that the covariance for class 1 is close to class 2 for this data.

Test set #2 is best modeled by model 1. Model 1 makes the fewest assumptions about the covariance of the data. Since this model worked best, the data may be dependent in $\textbf x$ and has unique variances for each dimension. And the covariance is different for class 1 and class 2.

The model 3 represents data that is independent in $\textbf x$ and has the same variance for all dimensions for a given class. Since test set #3 is best fit by model 3, this indicates that the data in #3 is independent in $\textbf x$ and that a single class variance is a good approximation across the dimensions.

# Question 2

## 2(a)

    ERROR RESULTS FOR 2(A)
    ------------------
    The error rate for k=1 is: 0.053872
    The error rate for k=3 is: 0.040404
    The error rate for k=5 is: 0.043771
    The error rate for k=7 is: 0.053872


## 2(b)

![2(b) Proportion of Variance: Optimal K is 21](pov_2b.png)

    ERROR RESULTS FOR 2(B)
    ------------------
    Error rate for k=1: 0.047138
    Error rate for k=3: 0.047138
    Error rate for k=5: 0.0538721
    Error rate for k=7: 0.0538721

## 2(c)

![2(c) PCA Plot for First Two Components on Training Data](train_2c.png)

![2(c) PCA Plot for First Two Components on Test Data](test_2c.png)

## 2(d)

    RESULTS TABLE FOR 2(D)
    --------------
    L	k	Error
    --------------
    2	1	0.750842
    2	3	0.771044
    2	5	0.744108
    4	1	0.707071
    4	3	0.717172
    4	5	0.676768
    9	1	0.47138
    9	3	0.444444
    9	5	0.424242

## 2(e)

![2(e) LDA Plot for First Two Components on Training Data](train_2e.png)

![2(e) LDA Plot for First Two Components on Test Data](test_2e.png)

# Question 3

## 3(a)

![3(a) First Five Eigen-Faces](pca_3a.png)

## 3(b)

    ERROR RESULTS FOR 3(B)
    ------------------
    Error rate for k=1: 0.112903
    Error rate for k=3: 0.233871
    Error rate for k=5: 0.41129
    Error rate for k=7: 0.435484

![3(b) Proportion of Variance: Optimal K is 41](ftrain_3b.png)

## 3(c)

The results in the following three pictures show the back projected images compared to the originals. In the first graphic, the images are blurry and only vaguely look like the originals. In the second graphic, some facial features are visible as are the sunglasses. In the final graphic for K of 100, the features are more visible than K of 10 or 50. In all of the graphics there is error as the images are not as clear as the originals.

![3(c) Back Projected Results for First 10 Components](back_face_10.png)

![3(c) Back Projected Results for First 50 Components](back_face_50.png)

![3(c) Back Projected Results for First 100 Components](back_face_100.png)